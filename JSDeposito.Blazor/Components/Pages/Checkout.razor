@page "/checkout"
@using MudBlazor
@inject CartService CartService

<MudContainer MaxWidth="MaxWidth.Medium">

    <MudText Typo="Typo.h4" Class="mb-4">
        💳 Checkout
    </MudText>

    <!-- RESUMO -->
    <MudPaper Class="pa-4 mb-4">
        <MudText Typo="Typo.h6">Resumo do pedido</MudText>
        <MudDivider Class="my-2" />

        @foreach (var item in CartService.Pedido!.Itens)
        {
            <MudStack Row Spacing="2" AlignItems="AlignItems.Center" Class="mb-3">

                <MudAvatar Image="images/sem-foto.png" />

                <MudStack Class="flex-grow-1">
                    <MudText>@item.ProdutoNome</MudText>
                    <MudText Typo="Typo.caption">
                        R$ @item.PrecoUnitario.ToString("N2")
                    </MudText>
                </MudStack>

                <MudNumericField T="int"
                                 Min="1"
                                 Value="@item.Quantidade"
                                 Immediate="true"
                                 ValueChanged="q => CartService.AlterarQuantidadeAsync(item.ProdutoId, q)"
                                 Style="width:70px" />

                <MudIconButton Icon="@Icons.Material.Filled.Delete"
                               Color="Color.Error"
                               OnClick="() => CartService.RemoverItemAsync(item.ProdutoId)" />
            </MudStack>
        }

        <MudDivider Class="my-2" />

        <MudText Typo="Typo.subtitle1">
            Total: <b>R$ @CartService.Pedido.Total.ToString("N2")</b>
        </MudText>
    </MudPaper>

    <!-- PAGAMENTO -->
    <MudButton Color="Color.Success"
               Variant="Variant.Filled"
               Size="Size.Large"
               FullWidth>
        Pagar com PIX
    </MudButton>

</MudContainer>
